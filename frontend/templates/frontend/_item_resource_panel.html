{% load i18n %}

{% for resource in resources %}

    <div class="col-lg-6 col-md-4 col-sm-6 col-xs-12">
        <div class="card">
            <div class="header">
                <div class="row clearfix">
                    <div class="col-xs-12 col-sm-6">
                        <h2>
                            {% if resource.ckan_resource_id %}
                                {{ resource.name }}

                                </a>
                            {% else %}
                                {{ resource.name }}
                            {% endif %}
                            <small><a href="{{ resource.ckan.url }}" target="_blank">{{ resource.ckan.name }}
                                - {{ resource.ckan.url }}</a></small>
                        </h2>
                    </div>

                    <div class="col-xs-12 col-sm-6">
                        <div class="btn-group" role="group">

                            <a type="button" href="{% url 'frontend:resource_edit' resource.id %}"
                               class="btn bg-teal waves-effect" data-toggle="tooltip" data-placement="right"
                               title="{% trans 'Edit' %}">
                                <i class="material-icons">mode_edit</i>
                            </a>

                            <a type="button" href="{% url 'frontend:data_dictionary_resource' resource.id %}"
                               class="btn bg-teal waves-effect" data-toggle="tooltip" data-placement="right"
                               title="{% trans 'Data Dictionary' %}">
                                <i class="material-icons">assignment</i>
                            </a>

                            <a type="button" href="{% url 'frontend:schedule_resource' resource.id %}"
                               class="btn bg-teal waves-effect" data-toggle="tooltip" data-placement="right"
                               title="{% trans 'Schedule' %}">
                                <i class="material-icons">alarm_add</i>
                            </a>

                            <a type="button" href="{% url 'frontend:resource_notification' resource.id %}"
                               class="btn bg-teal waves-effect" data-toggle="tooltip" data-placement="right"
                               title="{% trans 'Notification' %}">
                                <i class="material-icons">email</i>
                            </a>

                        </div>

                        <div class="btn-group" role="group">

                            <a type="button" href="{% url 'frontend:resource_log' resource.id %}"
                               class="btn bg-teal waves-effect" data-toggle="tooltip" data-placement="right"
                               title="Log">
                                <i class="material-icons">subject</i>
                            </a>

                            <a type="button" href="{%  url 'frontend:data_quality_resource' resource.id %}"
                               class="btn bg-teal waves-effect" data-toggle="tooltip" data-placement="right"
                               title="Data Quality Feedback">
                                <i class="material-icons">assessment</i>
                            </a>

                            <a type="button" href="{{ resource.resource_url }}" target="_blank"
                               class="btn bg-teal waves-effect" data-toggle="tooltip" data-placement="right"
                               title="Link">
                                <i class="material-icons">link</i>
                            </a>

                        </div>
                    </div>
                </div>
            </div>

            <div class="body">

                <div class="form-group">
                    <labe><b>{% trans 'Description:' %}</b></labe>
                    <br>
                    {{ resource.description | truncatechars:140 }}
                </div>

                <div class="form-group">
                    <b>{% trans 'Scheduled to:' %}</b>
                    {% if resource.get_last_schedule %}
                        {{ resource.get_last_schedule.schedule_date_time | date:"d/m/Y" }}
                        (EVERY {{ resource.schedule_type }})</br>
                    {% else %}
                        {% trans 'Not scheduled' %}
                    {% endif %}

                    {% if resource.get_last_success_schedule %}
                        <b>{%  trans 'Last update:' %} </b>{{ resource.get_last_success_schedule.schedule_date_time | date:"d/m/Y" }}
                    {% endif %}
                </div>


            </div>
        </div>
    </div>

{% endfor %}
